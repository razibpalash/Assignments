@model Assignment.Web.Service.ViewModels.BusinessEntityAddViewModel
@using Assignment.Web.Service.ViewModels

@{
    ViewData["Title"] = "Edit";

}
@section Css
    {
    <style>
        form .form-row {
            margin-bottom: 15px;
        }

        .form-check-label {
            margin-right: 15px;
        }

        .form-check-input {
            width: 20px;
            height: 20px;
            top: 20px;
        }

        .error {
            color: red;
        }
    </style>
}
<h2>Add</h2>



<ul class="nav nav-tabs" id="myTab" role="tablist">
    <li class="nav-item">
        <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Agent Info</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" id="user-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="false">Users</a>
    </li>
</ul>
<div class="tab-content" id="myTabContent">
    <div class="tab-pane fade show active mt-5" id="home" role="tabpanel" aria-labelledby="home-tab">
        <form id="agentForm" method="post" enctype="multipart/form-data">
            <div class="row">
                <div class="col-12">
                    <h4 class="text-danger" id="errorMessage"></h4>
                </div>
                <!--Left Col-->
                <div class="col-6">
                    <div class="form-row">
                        <label class="col-3">ID/Code</label>
                        <div class="col">
                            <input type="text" class="form-control" asp-for="Code" name="code" />
                        </div>
                    </div>

                    <div class="form-row">
                        <label class="col-3">Name</label>
                        <div class="col">
                            <input type="text"  class="form-control" name="name" />
                        </div>
                    </div>

                    <div class="form-row">
                        <label class="col-3">Markup Plan</label>
                        <div class="col">
                            <select class="form-control" name="markupPlanId" asp-items="@ViewBag.MarkupPlans"></select>
                        </div>
                    </div>

                    <div class="form-row">
                        <label class="col-3">Email</label>
                        <div class="col">
                            <input type="email" class="form-control" name="email" />
                        </div>
                    </div>

                    <div class="form-row">
                        <label class="col-3">Mobile</label>
                        <div class="col">
                            <input type="text" class="form-control" name="mobile" />
                        </div>
                    </div>

                    <div class="form-row">
                        <label class="col-3">Phone</label>
                        <div class="col">
                            <input type="text" class="form-control" name="phone" />
                        </div>
                    </div>

                    <div class="form-row">
                        <label class="col-3">Address</label>
                        <div class="col">
                            <textarea class="form-control" name="address"></textarea>
                        </div>
                    </div>

                    <div class="form-row">
                        <label class="col-3">city</label>
                        <div class="col">
                            <input type="text" class="form-control" name="city" />
                        </div>
                    </div>

                    <div class="form-row">
                        <label class="col-3">State</label>
                        <div class="col">
                            <input type="text" class="form-control" name="state" />
                        </div>
                    </div>

                    <div class="form-row">
                        <label class="col-3">Country</label>
                        <div class="col">
                            <input type="text" class="form-control" name="country" />
                        </div>
                    </div>

                    <div class="form-row">
                        <label class="col-3">Zip/Postal Code</label>
                        <div class="col">
                            <input type="text" class="form-control" name="zip" />
                        </div>
                    </div>

                    <div class="form-row">
                        <label class="col-3">Logo</label>
                        <div class="col">
                            <input type="file" id="logoFile" class="form-control" name="logoFile" />
                        </div>
                    </div>

                    <div class="form-row">
                        <label class="col-3">Contact Person</label>
                        <div class="col">
                            <input type="text" class="form-control" name="contactPerson" />
                        </div>
                    </div>

                    <div class="form-row">
                        <label class="col-3">Referred By</label>
                        <div class="col">
                            <input type="text" class="form-control" name="referredBy" />
                        </div>
                    </div>

                    <div class="form-row">
                        <label class="col-3">Balance</label>
                        <div class="col">
                            <input type="number" value="0" class="form-control text-right" name="balance" />
                        </div>
                    </div>

                    <hr />
                    <div class="form-row">
                        <label class="col-3">SMTP Server</label>
                        <div class="col">
                            <input type="text" class="form-control" name="smtpServer" />
                        </div>
                    </div>

                    <div class="form-row">
                        <label class="col-3">SMTP Port</label>
                        <div class="col">
                            <input type="number" value="0" class="form-control" name="smtpPort" />
                        </div>
                    </div>

                    <div class="form-row">
                        <label class="col-3">SMTP Username</label>
                        <div class="col">
                            <input type="text" class="form-control" name="smtpUsername" />
                        </div>
                    </div>

                    <div class="form-row">
                        <label class="col-3">SMTP Password</label>
                        <div class="col">
                            <input type="text" class="form-control" name="smtpPassword" />
                        </div>
                    </div>

                </div>


                <!--Right Col-->
                <div class="col-6">

                    <div class="form-row">
                        <div class="col-12">
                            <label>Flight APIs</label>
                        </div>

                        <div class="col">
                            <div class="form-check-inline form-check">
                                <label for="inline-checkbox1" class="form-check-label ">
                                    <input type="checkbox" id="inline-checkbox1" name="flightApi" value="Regent" class="form-check-input">Regent
                                </label>
                                <label for="inline-checkbox2" class="form-check-label ">
                                    <input type="checkbox" id="inline-checkbox2" name="flightApi" value="Novo" class="form-check-input">Novo
                                </label>
                                <label for="inline-checkbox3" class="form-check-label ">
                                    <input type="checkbox" id="inline-checkbox3" name="flightApi" value="Galileo" class="form-check-input">Galileo
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="col-12">
                            <label>Agent Type</label>
                        </div>

                        <div class="col">
                            <div class="form-check-inline form-check">
                                <label for="inline-checkbox1" class="form-check-label ">
                                    <input type="checkbox" id="agentType1" name="agentType" value="B2B" class="form-check-input">B2B
                                </label>
                                <label for="inline-checkbox2" class="form-check-label ">
                                    <input type="checkbox" id="agentType2" name="agentType" value="B2C" class="form-check-input">B2C
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="col-12">
                            <label>Status</label>
                        </div>

                        <div class="col ">
                            <div class="form-check-inline form-check status">
                                @foreach (var item in ViewBag.StatusList)
                                {
                                    <label class="form-check-label ">
                                        <input type="checkbox" name="status" value="@item.Value" checked="@item.IsChecked" class="form-check-input">@item.Text
                                    </label>
                                }
                            </div>

                            <div class="statusError"></div>
                        </div>
                    </div>


                </div>
            </div>
            <div class="row">
                <div class="col">
                    <button type="submit" class="btn btn-success">Save</button>
                    <button type="reset" class="btn btn-danger">Reset</button>
                </div>
            </div>
        </form>
    </div>
    <div class="tab-pane fade mt-5" id="profile" role="tabpanel" aria-labelledby="user-tab">
        <h1> Saving for future development</h1>
    </div>
</div>


@section Scripts
    {

    <script src="~/lib/jquery-validation/dist/jquery.validate.js"></script>
    <script src="~/lib/jquery-validation/dist/additional-methods.js"></script>

    <script>
        jQuery.validator.setDefaults({
            debug: true,
            success: "valid"
        });
        jQuery(function ($) {
            //checkbox single select
            $('.status input[type="checkbox"]').on('change', function () {
                $('.status input[name="' + this.name + '"]').not(this).prop('checked', false);
            });


            //adding file for parsing

            var fileInput = $('#logoFile')[0];
            var file = fileInput.files[0];



            $("#agentForm").validate({
                rules: {
                    code: {
                        required: true,
                        minlength: 3
                    },
                    name: {
                        required: true,
                        minlength: 3
                    },
                    email: {
                        required: true,
                        email:true
                    },
                    logoFile: {
                        accept: "image/*"
                    },
                    status: {
                        required:true
                    },
                    balance: {
                        required: true,
                        min:0
                    },
                    port: {
                        required: true,
                        min: 0
                    }
                },
                messages: {
                    code: {
                        required: "Code Required"
                    },
                    name: {
                        required: "Name Required"
                    },
                    email: {
                        required: "Email Required",
                    },
                    logoFile: {
                        accept: "Logo must be Image"
                    },
                    status: {
                        required: "Select any Status"
                    }
                },
                errorPlacement: function(error, element) {
                    if (element.attr("name") == "status" )
                        error.insertAfter(".statusError");
                    else
                        error.insertAfter(element);
                },
                submitHandler: function (form) {
                    $.ajax({
                        url: "/Agent/Add",
                        type: "POST",
                        data: $(form).serialize(),
                        success: function (response) {
                            console.log(response);
                            $("#errorMessage").text(response.message);
                            $("#errorMessage").focus();
                            if (!response.success) {

                                $("#errorMessage").addClass("text-danger");
                                $("#errorMessage").removeClass("text-success");
                                return;
                            }

                            $("#errorMessage").removeClass("text-danger");
                            $("#errorMessage").addClass("text-success");
                        }
                    });
                }
            });




        });
    </script>
}
}



